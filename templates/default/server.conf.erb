# OpenVPN server config file
#
# Generated by Chef - local changes will be overwritten

port <%= @port %>
proto <%= @proto %>
<% if @type == "server-bridge" -%>
dev tap
<% else -%>
dev tun
<% end -%>
keepalive 10 120
comp-lzo
local <%= @local %>
<% if @routes -%>
<% @routes.each do |route| -%>
<%= route %>
<% end -%>
<% end -%>
<% if @script_security > 1 -%>
up /etc/openvpn/server.up.sh
<% end -%>

# Keys and certificates.
ca   <%= @key_dir %>/ca.crt
key  <%= @key_dir %>/server.key # This file should be kept secret.
cert <%= @key_dir %>/server.crt
dh   <%= @key_dir %>/dh<%= @key_size %>.pem

ifconfig-pool-persist /etc/openvpn/ipp.txt

<% if @type == "server" -%>
<%= @type %> <%= @subnet %> <%= @netmask %>
<% end -%>

user <%= @user %>
group <%= @group %>

# avoid accessing certain resources on restart
persist-key
persist-tun

# current client connections
status /etc/openvpn/openvpn-status.log

# logging settings.
log-append  <%= @log %>
verb 1  # don't spam the log with messages.
mute 10 # suppress identical messages > 10 occurances.

script-security <%= @script_security %>
